{% extends 'base.html.twig' %}

{% block body %}
  <h1 class="text-2xl font-bold mb-4">Liste des événements</h1>

  <form method="get" class="mb-6 space-y-4">
    <div>
      <label>Entre :</label>
      <input type="date" name="start" value="{{ filters.start ?? '' }}" />
      <label>et</label>
      <input type="date" name="end" value="{{ filters.end ?? '' }}" />
    </div>

    <div>
      <label>Jeu :</label>
      <select name="game">
        <option value="">Tous</option>
        {% for g in games %}
          {% set selected = filters.game ?? '' == g.slug ? 'selected' : '' %}
          <option value="{{ g.slug }}" {{ selected }}>{{ g.name }}</option>
        {% endfor %}
      </select>
    </div>

    <div>
      <label>Mode complet :</label>
      <input type="text" name="fullMode" value="{{ filters.fullMode ?? '' }}" placeholder="Ex: creative > boxfight > 2v2" />
    </div>

    <div>
      <label>Nom :</label>
      <input type="text" name="name" value="{{ filters.name ?? '' }}" placeholder="Tournoi Fortnite..." />
    </div>

    <div>
      {% set isChecked = filters.upcoming ?? false ? 'checked' : '' %}
      <label><input type="checkbox" name="upcoming" {{ isChecked }} />Événements à venir seulement</label>
    </div>

    <div>
      <button type="submit" class="btn btn-primary">Filtrer</button>
    </div>
  </form>

  {% if events is not empty %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {% for event in events %}
        {% if event.date >= ('now'|date('Y-m-d')) %}
          <div class="p-4 border rounded shadow-sm bg-white">
            {% if event.image %}
              <img src="{{ asset('images/events/' ~ event.image) }}" alt="{{ event.name }}" class="w-full mb-2" />
            {% else %}
              <img src="{{ asset('images/heroes/' ~ event.game.slug ~ '_heroes.png') }}" alt="{{ event.game.name }}" class="w-full mb-2" />
            {% endif %}
            <strong>{{ event.name }}</strong><br />
            {{ event.date|date('d/m/Y') }} – {{ event.game.name }}<br />
            {{ event.category }} / {{ event.mode }}{% if event.format %}
              / {{ event.format }}
            {% endif %}<br />
            <a href="{{ path('app_event_show', { slug: event.game.slug, id: event.id }) }}" class="text-blue-600 hover:underline">Voir</a>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  {% else %}
    <p>Aucun événement trouvé.</p>
  {% endif %}
{% endblock %}
